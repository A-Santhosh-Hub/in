
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yogi P.M. Moorthy Ayya</title>
    <link rel="icon" type="image/png" href="Dr.S.Pothuvudaimoorthy.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=Promise%2Cfetch"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
        }

        .serif {
            font-family: 'Playfair Display', serif;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        /* Masonry Grid Logic */
        .gallery-columns {
            column-count: 2;
            column-gap: 8px;
            /* Slightly tighter gap for mobile 2-col */
        }

        @media (min-width: 640px) {
            .gallery-columns {
                column-count: 2;
            }
        }

        @media (min-width: 1024px) {
            .gallery-columns {
                column-count: 3;
            }
        }

        /* Mobile specific overrides */
        .video-columns {
            column-count: 1 !important;
        }

        @media (min-width: 640px) {
            .video-columns {
                column-count: 2 !important;
                /* Back to 2 on tablet */
            }
        }

        @media (min-width: 1024px) {
            .video-columns {
                column-count: 3 !important;
                /* Back to 3 on desktop */
            }
        }

        .gallery-item {
            break-inside: avoid;
            margin-bottom: 8px;
        }

        /* Smooth Transitions */
        .fade-overlay {
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.5) 100%);
        }

        .tab-active {
            border-bottom: 2px solid #000;
            color: #000;
        }

        .zoom-active {
            transform: scale(1.5);
            cursor: zoom-out;
        }

        .liked {
            color: #ef4444 !important;
            fill: #ef4444;
            stroke: #ef4444;
        }

        /* Selection Checkbox Styles */
        .checkbox-ring {
            width: 24px;
            height: 24px;
            border: 2px solid white;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.2);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .checkbox-ring.selected {
            background-color: #2563eb;
            border-color: #2563eb;
        }

        /* Modal Animation Utilities */
        .modal-enter {
            opacity: 0;
            transform: scale(0.95);
        }

        .modal-enter-active {
            opacity: 1;
            transform: scale(1);
            transition: opacity 300ms, transform 300ms;
        }
    </style>
</head>

<body class="text-zinc-900 selection:bg-black selection:text-white">

    <!-- 1. FULLSCREEN HERO SECTION -->
    <header class="relative h-screen w-full flex items-center justify-center overflow-hidden bg-black">
        <img id="hero-img" src="" class="absolute inset-0 w-full h-full object-cover md:object-contain"
            alt="Wedding Hero">
        <div class="absolute inset-0 fade-overlay"></div>

        <div class="relative z-10 text-center text-white px-4">
            <p class="text-[10px] md:text-xs tracking-[0.2em] mb-4 opacity-80 uppercase" id="hero-date"></p>
            <h1 class="text-3xl md:text-6xl lg:text-7xl serif tracking-wider mb-6 uppercase" id="hero-title"></h1>
            <div
                class="text-[10px] md:text-xs tracking-widest opacity-70 flex flex-col md:flex-row items-center justify-center gap-2 md:gap-4 uppercase">
                <!-- Updated Photographer Link -->
                <a href="#" target="_blank" id="photographer-name"
                    class="hover:text-white hover:underline underline-offset-4 transition-all"></a>
                <span class="hidden md:block">|</span>
                <a href="#" class="underline underline-offset-4" id="portfolio-link"></a>
            </div>
        </div>

        <!-- Scroll Down Arrow -->
        <div class="absolute bottom-10 left-1/2 -translate-x-1/2 text-white animate-bounce cursor-pointer"
            onclick="scrollToGallery()">
            <i data-lucide="chevron-down" class="w-6 h-6"></i>
        </div>
    </header>

    <!-- 2. STICKY ACTION BAR -->
    <div id="gallery-section"
        class="sticky top-0 z-50 bg-white border-b border-zinc-100 px-4 md:px-10 py-3 flex justify-between items-center">
        <!-- Tabs -->
        <div class="flex gap-6 md:gap-8 overflow-x-auto no-scrollbar">
            <button onclick="switchTab('CAM 01')"
                class="text-[10px] font-bold tracking-widest uppercase pb-2 transition-all tab-btn tab-active"
                id="tab-01">CAM 01</button>
            <button onclick="switchTab('CAM 02')"
                class="text-[10px] font-bold tracking-widest uppercase pb-2 transition-all tab-btn text-zinc-400 hover:text-zinc-900"
                id="tab-02">CAM 02</button>
            <button onclick="switchTab('VIDEOS')"
                class="text-[10px] font-bold tracking-widest uppercase pb-2 transition-all tab-btn text-zinc-400 hover:text-zinc-900"
                id="tab-videos">VIDEOS</button>
        </div>

        <!-- Utilities -->
        <div class="flex items-center gap-4 md:gap-6 relative">
            <div class="flex items-center gap-1 group cursor-pointer" onclick="filterLikes()">
                <button id="nav-heart"><i data-lucide="heart" class="w-4 h-4"></i></button>
                <span id="like-count" class="text-[10px] font-bold">0</span>
            </div>
            <button class="hover:opacity-60 transition-opacity"><i data-lucide="send" class="w-4 h-4"></i></button>
            <!-- Contact Button -->
            <button onclick="openContactModal()" class="hover:opacity-60 transition-opacity"><i
                    data-lucide="message-circle" class="w-4 h-4"></i></button>

            <!-- Download Button & Dropdown -->
            <div class="relative">
                <button id="download-trigger" onclick="toggleDownloadMenu()"
                    class="hidden md:flex items-center gap-2 border border-zinc-900 px-4 py-1.5 rounded-sm text-[10px] font-bold tracking-widest uppercase hover:bg-black hover:text-white transition-all">
                    Download Files <i data-lucide="chevron-down" class="w-3 h-3"></i>
                </button>
                <!-- Dropdown Menu -->
                <div id="download-menu"
                    class="absolute right-0 top-full mt-2 w-56 bg-white rounded-lg shadow-xl border border-zinc-100 hidden flex-col overflow-hidden z-[60] animate-fade-in">
                    <button onclick="startSelectionMode()"
                        class="text-left px-4 py-3 text-xs font-medium hover:bg-zinc-50 border-b border-zinc-50 w-full flex items-center gap-2">
                        <i data-lucide="check-square" class="w-3 h-3"></i> Select photos to download
                    </button>
                    <button onclick="downloadAllInTab()"
                        class="text-left px-4 py-3 text-xs font-medium hover:bg-zinc-50 w-full flex items-center gap-2">
                        <i data-lucide="download-cloud" class="w-3 h-3"></i> Download all <span
                            id="current-tab-name">CAM 01</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 3. GALLERY BODY -->
    <main class="bg-white min-h-screen">
        <div class="py-12 text-center">
            <h2 class="text-xs font-bold tracking-[0.4em] uppercase serif" id="gallery-subtitle"></h2>
            <!-- Selection Mode Instructions -->
            <div id="selection-instructions" class="hidden mt-4">
                <p class="text-xs text-zinc-500 bg-zinc-100 inline-block px-4 py-2 rounded-full">
                    Click on photos to select them for download
                </p>
            </div>
        </div>

        <!-- Photo Grid -->
        <div class="max-w-[1600px] mx-auto px-4 md:px-10 pb-24">
            <div id="photo-grid" class="gallery-columns">
                <!-- Images Injected Here -->
            </div>
        </div>
    </main>

    <!-- 4. FLOATING SELECTION BAR (Visible only in selection mode) -->
    <div id="selection-bar"
        class="fixed bottom-0 left-0 right-0 z-[70] bg-white border-t border-zinc-200 p-4 transform translate-y-full transition-transform duration-300 shadow-[0_-5px_20px_rgba(0,0,0,0.1)]">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-4">
                <button onclick="cancelSelectionMode()" class="p-2 hover:bg-zinc-100 rounded-full">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
                <div class="flex flex-col">
                    <span class="text-sm font-bold"><span id="selected-count">0</span> Selected</span>
                    <button onclick="selectAll()"
                        class="text-[10px] text-zinc-500 hover:text-black underline text-left">Select All</button>
                </div>
            </div>
            <button onclick="downloadSelectedBatch()"
                class="bg-black text-white px-6 py-2 rounded-lg text-xs font-bold uppercase tracking-widest hover:bg-zinc-800 transition-colors">
                Download Selected
            </button>
        </div>
    </div>

    <!-- 5. FLOATING CHAT BUBBLE -->
    <div class="fixed bottom-6 right-6 z-[60]" id="chat-bubble">
        <button onclick="openContactModal()"
            class="bg-black text-white p-4 rounded-full shadow-2xl hover:scale-110 transition-transform">
            <i data-lucide="message-square" class="w-6 h-6"></i>
        </button>
    </div>

    <!-- 6. LIGHTBOX VIEWER -->
    <div id="lightbox" class="fixed inset-0 z-[100] bg-white hidden flex-col transition-opacity duration-300">
        <div
            class="flex justify-between items-center p-6 border-b border-zinc-50 bg-white/95 backdrop-blur-sm relative z-50">
            <!-- Left: Counter -->
            <div id="lb-counter" class="text-[10px] font-bold tracking-widest uppercase text-zinc-400 w-24"></div>

            <!-- Center: Download -->
            <button onclick="downloadCurrent()"
                class="hidden md:flex items-center gap-2 text-[10px] font-bold tracking-widest uppercase text-zinc-900 hover:opacity-60 transition-opacity">
                <i data-lucide="download" class="w-4 h-4"></i> Download
            </button>

            <!-- Right: Actions -->
            <div class="flex items-center gap-4 md:gap-6 w-24 justify-end">
                <button id="lb-heart-btn" onclick="toggleLikeCurrent()" title="Like">
                    <i data-lucide="heart" class="w-5 h-5 cursor-pointer hover:scale-110 transition-transform"></i>
                </button>

                <button onclick="shareCurrent()" title="Share">
                    <i data-lucide="share-2" class="w-5 h-5 cursor-pointer hover:scale-110 transition-transform"></i>
                </button>

                <button onclick="toggleZoom()" title="Zoom">
                    <i data-lucide="zoom-in" class="w-5 h-5 cursor-pointer hover:scale-110 transition-transform"></i>
                </button>

                <button onclick="toggleFullscreen()" title="Fullscreen" class="hidden md:block">
                    <i data-lucide="maximize" class="w-5 h-5 cursor-pointer hover:scale-110 transition-transform"></i>
                </button>

                <button onclick="closeLightbox()" title="Close">
                    <i data-lucide="x"
                        class="w-6 h-6 cursor-pointer hover:rotate-90 transition-transform text-zinc-400 hover:text-zinc-900"></i>
                </button>
            </div>
        </div>
        <div class="flex-1 relative flex items-center justify-center p-4">
            <button onclick="changePhoto(-1)" class="absolute left-6 p-4 hover:bg-zinc-50 rounded-full"><i
                    data-lucide="chevron-left"></i></button>
            <img id="lb-img" src="" class="max-w-full max-h-[80vh] object-contain transition-transform"
                onclick="toggleZoom()">
            <iframe id="lb-video" class="w-full h-[80vh] max-w-5xl hidden" frameborder="0" allow="autoplay; fullscreen"
                allowfullscreen></iframe>
            <button onclick="changePhoto(1)" class="absolute right-6 p-4 hover:bg-zinc-50 rounded-full"><i
                    data-lucide="chevron-right"></i></button>
        </div>
    </div>

    <!-- 7. SHARE MODAL -->
    <div id="share-modal"
        class="fixed inset-0 z-[110] bg-black/60 hidden items-center justify-center backdrop-blur-sm transition-opacity opacity-0"
        onclick="closeShareModal(event)">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-md p-6 relative transform scale-95 transition-transform duration-300"
            id="share-modal-content" onclick="event.stopPropagation()">
            <button onclick="closeShareModal()"
                class="absolute top-4 right-4 text-zinc-300 hover:text-zinc-600 transition-colors">
                <i data-lucide="x-circle" class="w-6 h-6"></i>
            </button>
            <h3 class="text-xl font-medium text-center mb-6">Share link</h3>
            <div class="mb-6">
                <input type="text" id="share-url-input"
                    class="w-full border border-zinc-200 rounded-lg px-4 py-3 text-sm text-zinc-600 focus:outline-none focus:border-zinc-400 bg-zinc-50"
                    readonly>
            </div>
            <button id="copy-btn" onclick="copyShareLink()"
                class="w-full bg-black text-white rounded-lg py-3 font-medium flex items-center justify-center gap-2 hover:bg-zinc-800 transition-colors mb-8">
                <i data-lucide="link" class="w-4 h-4"></i> <span id="copy-btn-text">Copy the link</span>
            </button>
            <div class="text-center">
                <p class="text-zinc-400 text-sm mb-4">Or share via social media</p>
                <div class="flex items-center justify-center gap-6">
                    <a href="#" id="share-fb" target="_blank" class="hover:scale-110 transition-transform"><svg
                            class="w-8 h-8 text-[#1877F2]" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                        </svg></a>
                    <a href="#" id="share-wa" target="_blank" class="hover:scale-110 transition-transform"><svg
                            class="w-8 h-8 text-[#25D366]" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
                        </svg></a>
                    <!-- Telegram -->
                    <a href="#" id="share-tg" target="_blank" class="hover:scale-110 transition-transform">
                        <svg class="w-8 h-8 text-[#26A5E4]" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 11.944 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.638z" />
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- 8. CONTACT MODAL -->
    <div id="contact-modal"
        class="fixed inset-0 z-[120] bg-black/60 hidden items-center justify-center backdrop-blur-sm transition-opacity opacity-0"
        onclick="closeContactModal(event)">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-sm p-8 relative transform scale-95 transition-transform duration-300 text-center"
            id="contact-modal-content" onclick="event.stopPropagation()">
            <!-- Close -->
            <button onclick="closeContactModal()"
                class="absolute top-4 right-4 text-zinc-300 hover:text-zinc-600 transition-colors">
                <i data-lucide="x-circle" class="w-6 h-6"></i>
            </button>

            <!-- Profile Image -->
            <div
                class="w-24 h-24 bg-zinc-900 rounded-full mx-auto mb-4 overflow-hidden shadow-inner flex items-center justify-center text-white text-2xl font-serif">
                SS
            </div>

            <h3 class="text-2xl font-bold mb-1">SanStudio</h3>
            <p class="text-sm text-zinc-500 font-medium mb-4">Web designer</p>

            <p class="text-xl font-medium mb-1 tracking-tight">+91 9003356047</p>
            <p class="text-sm text-zinc-500 mb-6">sanstudio.brand@gmail.com</p>

            <!-- Social Buttons Stack -->
            <div class="space-y-3 mb-6">
                <a href="https://wa.me/919003356047" target="_blank"
                    class="flex items-center justify-center gap-2 w-full border border-zinc-200 rounded-lg py-2.5 hover:bg-zinc-50 hover:border-zinc-400 transition-all font-medium text-sm text-zinc-700">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
                    </svg>
                    WhatsApp
                </a>
                <a href="https://t.me/+919003356047" target="_blank"
                    class="flex items-center justify-center gap-2 w-full border border-zinc-200 rounded-lg py-2.5 hover:bg-zinc-50 hover:border-zinc-400 transition-all font-medium text-sm text-zinc-700">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                        <path
                            d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 11.944 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.638z" />
                    </svg>
                    Telegram
                </a>
                <a href="https://www.instagram.com/santhosh_747_dark/" target="_blank"
                    class="flex items-center justify-center gap-2 w-full border border-zinc-200 rounded-lg py-2.5 hover:bg-zinc-50 hover:border-zinc-400 transition-all font-medium text-sm text-zinc-700">
                    <i data-lucide="instagram" class="w-4 h-4"></i> Instagram
                </a>
                <a href="https://www.youtube.com/@crazyvideos788" target="_blank"
                    class="flex items-center justify-center gap-2 w-full border border-zinc-200 rounded-lg py-2.5 hover:bg-zinc-50 hover:border-zinc-400 transition-all font-medium text-sm text-zinc-700">
                    <i data-lucide="youtube" class="w-4 h-4"></i> YouTube
                </a>
                <button onclick="saveContact()"
                    class="flex items-center justify-center gap-2 w-full bg-black text-white rounded-lg py-3 hover:bg-zinc-800 transition-colors font-bold text-sm">
                    Save contact
                </button>
            </div>

            <a href="https://sanstudio.neocities.org/" target="_blank"
                class="text-sm underline underline-offset-4 text-zinc-500 hover:text-black">Go to website</a>
        </div>
    </div>

    <script>
        // --- DATA ---
        const ALBUM_DATA = {
            title: "Yogi P.M. Moorthy Ayya | Birth Day",
            date: "2026-02-03",
            photographer: "Photographer VJ Ranjith",
            photographerUrl: "https://www.instagram.com/vj_ranjith.official/",
            portfolio: "By SanStudio",
            portfolioUrl: "https://sanstudio.neocities.org/",
            heroId: "1j4MeMfRDC6PMgbSXHphPkKIQaED0pRXJ",
            cam01: [

  { id: "17bibtxFLp2NTRDiP8HJ6mrNrcUwkM17g", name: "Birthday 1" },
  { id: "1fQpvC3byqrRUbSR4inh0q7KTgn9f-_HU", name: "Birthday 2" },
  { id: "1sxjc17wfj6c2MIfmmi2JcxAjbaBgt2CM", name: "Birthday 3" },
  { id: "1f3wmFafW6vjuISDX0G5a5wBfP4hy6_VO", name: "Birthday 4" },
  { id: "13qfpNtq8MChcPKcF1tW2mM1pzeGaulbZ", name: "Birthday 5" },
  { id: "1W31J4ql-MrB_nmA5h3cvcoVe8ZlrDQoa", name: "Birthday 6" },
  { id: "1c7q9Pl9zLTlfphN_mMG-Ngi8BMyAtJqN", name: "Birthday 7" },
  { id: "1Dams4IpX7IFO73KMq68Q9hWQtv700yj8", name: "Birthday 8" },
  { id: "1ymCgNfsy_e90qlDumSWjef0--eyHpI7x", name: "Birthday 9" },
  { id: "1Z_yULdUTTxuNl5SPbUKImqGdB08JOeX5", name: "Birthday 10" },
  { id: "1eKczYV5NOYia5wUdIrrHyuTt2klBN4k7", name: "Birthday 11" },
  { id: "1mSWMyI_myTYTBu1qV_RwMzsgzA89Demj", name: "Birthday 12" },
  { id: "1-2-JMr4p5hQmhpAXZfc84yT7yhOk6BGy", name: "Birthday 13" },
  { id: "1L2i3biPv0bwZkkkaotF819FnvpSbOtrl", name: "Birthday 14" },
  { id: "1zCUkdFvJqaIJ9PaZs5XPB9pS8Nsye-EC", name: "Birthday 15" },
  { id: "1Vb1vloh6z1DCPnuXVxLd-JK6qHbl5fMZ", name: "Birthday 16" },
  { id: "1-KOvIYpGBKjhvD-r7pSsiCoTVKYfVhto", name: "Birthday 17" },
  { id: "1uykXSgNwEooh5LoI4yIh8EkEV1427eXR", name: "Birthday 18" },
  { id: "1BcaXFY6EOr_PZgbmeAC-UE1gJ2wIFeFf", name: "Birthday 19" },
  { id: "1IJRD0QdSOkd-82JyTCIXGa5G8FcVqVIH", name: "Birthday 20" },
  { id: "1fuI47Gzb0IrOQ5U9NK-ELvELXUgyRks_", name: "Birthday 21" },
  { id: "1jppCDEbIHxuBz93_5dia0U_P1YGf0pfT", name: "Birthday 22" },
  { id: "1l1ftMjin8BK1Z2fdYYs3eNoQP6p-H7uc", name: "Birthday 23" },
  { id: "1g_21H4KVezByWJTAPY0rgSB3fTpZVLaq", name: "Birthday 24" },
  { id: "1nIvFxLg9s2KISdlLp1ZRyVFAwSqNu-Zx", name: "Birthday 25" },
  { id: "1VzUjpc2cLUkXpyyZGomgzHzs1ofKrdlx", name: "Birthday 26" },
  { id: "1IohRdyn8unGn9Tc6ZvvGhcOFqKpoy4Oc", name: "Birthday 27" },
  { id: "1r2o_fhHJJ-6RNs2Hl7W1Q3WIgC9XzlDb", name: "Birthday 28" },
  { id: "1dRCGjRF5FmdRiw32KlUokeshR_ubOUup", name: "Birthday 29" },
  { id: "191bj6Hl9QwTwgfQy0yWSZBn91N1rY2qG", name: "Birthday 30" },
  { id: "1NhopuU8OMXDkkobpSFb8XEIgWdJokQ3M", name: "Birthday 31" },
  { id: "1dGaW6ujQcIO7ftrRxTLbxdWyy9a_T87-", name: "Birthday 32" },
  { id: "1TgjPvT3j-D09mkEK2H777HldKLHrvYh1", name: "Birthday 33" },
  { id: "1fPmGlvO4_7T4Ypn-m5Ul6k-5tV5hT5mQ", name: "Birthday 34" },
  { id: "1yxyLg0zweo_ZA9jjr9peH0ZY2vo2gJ0k", name: "Birthday 35" },
  { id: "1jmsQBiO79OreTNV_4z0C5mdE00z168KR", name: "Birthday 36" },
  { id: "197YpU2PLeArUd1cKtochewrAtqjqjWtR", name: "Birthday 37" },
  { id: "11828uUD5d8wrH7VQmamk5hNjI62c2TqM", name: "Birthday 38" },
  { id: "14xHc0RfvI_aFCaElrAFFm9IvWS5HCS25", name: "Birthday 39" },
  { id: "1m91OssZaQVXJ6R9ecagArkH7eFonWKU8", name: "Birthday 40" },
  { id: "1MHo5dGUkrMOCE5Ahn3y99xHy5Mhs2GfY", name: "Birthday 41" },
  { id: "1SIckHU96kbVSxNEl6cDkjVITNqS0jupo", name: "Birthday 42" },
  { id: "1q28t-HhzOV9D3NPb1icKfO1NHdRselIV", name: "Birthday 43" },
  { id: "1ruE6rl2sjKYsHXVfd5-31FNebLeM0xja", name: "Birthday 44" },
  { id: "1ZTkn2pgZs00QIDvH2Zvfm4WhI-C-7rol", name: "Birthday 45" },
  { id: "1WD8T56_La4brfNRMaMCrXCEahV0E25-1", name: "Birthday 46" },
  { id: "1C3zg6j3elZb2i3Uz2InckLVL7xfLKDTY", name: "Birthday 47" },
  { id: "1qhYTEEG3Bu1lk2LC8Y3QS56rdXgRr2R4", name: "Birthday 48" },
  { id: "166vFMXmYBqnBRoQJ3-mXG6V85yvDywGw", name: "Birthday 49" },
  { id: "1sHUgiuN2BPKI2T7SfSgf_3qI130JVECz", name: "Birthday 50" },
  { id: "1-6nIAWUJYhwzrx2J13NwSAjYjMvyBK0h", name: "Birthday 51" },
  { id: "1Gow_H2qYcpFPW7A1zf3gncKzqRr3zYve", name: "Birthday 52" },
  { id: "1WVbOR5ugKnhPBFN1x6NQJvkdAJDZzx8T", name: "Birthday 53" },
  { id: "1gc9-yP5Ls2rFpuQwoTRHSuV0ahOGAHcR", name: "Birthday 54" },
  { id: "1A9PrugQpBBYXIiVnTvBz9PnA5VYfaixC", name: "Birthday 55" },
  { id: "1xs7CkEi9-Ll7-FXBGsqOUPvOXGdBTlZK", name: "Birthday 56" },
  { id: "1FHHKqgz_O_IgpZGSr0ZBmHxb5_DK_hlt", name: "Birthday 57" },
  { id: "1yzwjkrD7DoXuyWSSv9cjxk33erg98Xga", name: "Birthday 58" },
  { id: "1bnnbDEt4GUlYvA43i0jirayueRpHUDYA", name: "Birthday 59" },
  { id: "1RXR6TWqXD3rsnJ81haysLxS4n1Pwf1TX", name: "Birthday 60" },
  { id: "14BbZjt4wMZg_Q0NlPZ-J1xnOFTGknCjB", name: "Birthday 61" },
  { id: "1ZpLqC5zYrPXvgMuLgAS8jITAFqxQFAkS", name: "Birthday 62" },
  { id: "1Gwp3u4mkPr0iftj9awD6T4p9G1MI7VbL", name: "Birthday 63" },
  { id: "1hpSMY_ErEPcQbrm8pDS0EAZjB0OQebC5", name: "Birthday 64" },
  { id: "1HwryEYuAU5-dcoXtYf7XCxr4RMfZu9gi", name: "Birthday 65" },
  { id: "1DIve7VPvI3fq00uQZRWuT3VtjG01mhB2", name: "Birthday 66" },
  { id: "1xC4MNoj7-Szf_ZVYNILL4o5dvi-_xzfG", name: "Birthday 67" },
  { id: "1Mz01qF-6PnmHMaI1I_MF8IQXTHherpzs", name: "Birthday 68" },
  { id: "1mukLZzRMEvnKm9-p13bcowQkCTo3as7P", name: "Birthday 69" },
  { id: "13dkg7Gxifn90EpN6JWDlZ7SH20ZjdROC", name: "Birthday 70" },
  { id: "1c5HNnhC90ywZa_tIqrQFdkVrgz3bQAin", name: "Birthday 71" },
  { id: "13zConMmTRwGcT-pZJvEl_zjzsmmdhoqj", name: "Birthday 72" },
  { id: "1odEa8XL6ZHZzlMZ0xhkowEnFfN2bGpJ4", name: "Birthday 73" },
  { id: "1BTJAvH1MHiYpjKcfNDedR6uKH78-c_GI", name: "Birthday 74" },
  { id: "1SbgU9NpEUax6sCLAc3dFk2MEMkdzschc", name: "Birthday 75" },
  { id: "1uqe98QuEl21ekU9zXOb8eNDuaM9YQN8g", name: "Birthday 76" },
  { id: "1QmbY3ZvswykvJq8ZQxwCSYepYkSSCZfQ", name: "Birthday 77" },
  { id: "1Knv_-a0hjsRi2DXDd116oLyokgZcYoxR", name: "Birthday 78" },
  { id: "1llQ8bM8bP0eBJH3qrQOMvsoNzB9S9_fZ", name: "Birthday 79" },
  { id: "1JE81llkEuXYdiwM-Netu46QSYqrhDFBS", name: "Birthday 80" },
  { id: "1bbtCC2U-QTpUijlMxfXMPUXxGr46Ev-2", name: "Birthday 81" },
  { id: "1lCiJd-h3FK98MwKf2ml5HafTjzh5SHNA", name: "Birthday 82" },
  { id: "19gEYwV8OS9OqzkPdN5dEVxMWfWhMNR6Z", name: "Birthday 83" },
  { id: "1VGQEEBnjLr7tsYdePoDRu2rJbwQ11vuG", name: "Birthday 84" },
  { id: "1tnDJIc09uHox4A78GCdETRmhyuF9_TUd", name: "Birthday 85" },
  { id: "1j1S_qXuD_tPOJNj4UUuvEH2zFgotar76", name: "Birthday 86" },
  { id: "1CrSYVJ1k2C4MOtCBnEveOcu6WLKEEWji", name: "Birthday 87" },
  { id: "1g4LiZw-ZK9qUmDcLprCKz7LAYn2Nit7e", name: "Birthday 88" },
  { id: "1mKVhBgQWi_LoKwz6zlqlW0hJX4PAwv99", name: "Birthday 89" },
  { id: "1YX1GkfTR6QjC2mj4YTiqhqQtb0agu6HB", name: "Birthday 90" },
  { id: "1hEPCXMz9t5guRcDcylZkYamDTYrRwhXt", name: "Birthday 91" },
  { id: "1gGK72SB3InsbrM6UOGROX1xm0EcCKi5E", name: "Birthday 92" },
  { id: "1yDRazsXaOGfSFELvwaOyi2CeTHQdgHRJ", name: "Birthday 93" },
  { id: "1GWrguGxLcldPeR1CIds7AQrCjOqSulOb", name: "Birthday 94" },
  { id: "1DJjW1RYTan4vHLyn8jtR1x9q6tQd7k_C", name: "Birthday 95" },
  { id: "1-R_d8cpM1yUtaVgdZW7AsFm4uPvy49Pb", name: "Birthday 96" },
  { id: "1j4MeMfRDC6PMgbSXHphPkKIQaED0pRXJ", name: "Birthday 97" },
  { id: "1pm3FYhelOgumtkqlK8nGnVyi4hmVJRrv", name: "Birthday 98" },
  { id: "1CxKbjfzWJs5WdhAMlYQdofDPrUssZpFa", name: "Birthday 99" },
  { id: "1V8k29khVyfXHQue-q7v-ZH9U1-WmrqTQ", name: "Birthday 100" },
  { id: "1g22hWg5Oo8lTxAJublLlcVl14cWZKjJi", name: "Birthday 101" },
  { id: "1-9Dr-W5nPL8cupLCv6hjEMwGI9efZ_Jc", name: "Birthday 102" },
  { id: "1zWhv7jI5C1YUuCCzy888g_SPJe_qL_29", name: "Birthday 103" },
  { id: "1bEHQ455d-T1NW-9I1wqfALwHkFBQOqr8", name: "Birthday 104" },
  { id: "1il_9FBOMqPM3bAyyjvVHlYwqlPIDc_14", name: "Birthday 105" }
],

                  




       cam02: [



            ],


            
            videos: [
                { id: "", name: "irthday Highlights" }
            ]
        };

        const getDriveUrl = (id) => `https://lh3.googleusercontent.com/d/${id}`;
        const getDownloadUrl = (id) => `https://drive.google.com/uc?export=download&id=${id}`;
        const getVideoUrl = (id) => `https://drive.google.com/file/d/${id}/preview`;

        let currentTab = 'CAM 01';
        let currentIndex = 0;
        let isZoomed = false;
        let likedPhotos = new Set(JSON.parse(localStorage.getItem('wedding_likes') || '[]'));

        // Selection Mode State
        let isSelectionMode = false;
        let selectedPhotos = new Set();

        // --- INIT ---
        function init() {
            document.getElementById('hero-img').src = getDriveUrl(ALBUM_DATA.heroId);
            document.getElementById('hero-title').textContent = ALBUM_DATA.title;
            document.getElementById('hero-date').textContent = ALBUM_DATA.date;

            // Set Photographer info
            const photogName = document.getElementById('photographer-name');
            photogName.textContent = ALBUM_DATA.photographer;
            photogName.href = ALBUM_DATA.photographerUrl;

            const portfolioLink = document.getElementById('portfolio-link');
            portfolioLink.textContent = ALBUM_DATA.portfolio;
            portfolioLink.href = ALBUM_DATA.portfolioUrl;
            portfolioLink.target = "_blank";

            document.getElementById('gallery-subtitle').textContent = "Dr.S.Pothuvudaimoorthy";
            document.getElementById('current-tab-name').textContent = currentTab;

            updateLikeCount();
            renderGallery();
            lucide.createIcons();

            // Fixed Click Listener for Dropdown
            document.addEventListener('click', (e) => {
                const menu = document.getElementById('download-menu');
                // Use ID selector which is much more robust than text content check
                const btn = e.target.closest('#download-trigger');

                // If clicked button, toggle logic is handled by onclick, so we return
                if (btn) return;

                // If clicked outside menu, hide it
                if (menu && !menu.classList.contains('hidden') && !menu.contains(e.target)) {
                    menu.classList.add('hidden');
                    menu.classList.remove('flex');
                }
            });
        }

        function renderGallery() {
            const grid = document.getElementById('photo-grid');
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else images = ALBUM_DATA.videos;

            if (images.length === 0) {
                grid.innerHTML = `<div class="col-span-full py-20 text-center text-zinc-300 text-xs tracking-widest">NO PHOTOS IN THIS TAB YET</div>`;
                return;
            }

            if (isSelectionMode) {
                // RENDER FOR SELECTION MODE
                grid.innerHTML = images.map((img, idx) => `
                    <div class="gallery-item cursor-pointer overflow-hidden group relative" onclick="toggleSelection('${img.id}')">
                        <img src="${getDriveUrl(img.id)}" 
                             class="w-full h-auto object-cover transition-opacity duration-300 ${selectedPhotos.has(img.id) ? 'opacity-80' : ''}"
                             onerror="this.src='https://via.placeholder.com/800x1200?text=Access+Denied'">
                        
                        <div class="absolute inset-0 bg-black/10 transition-opacity ${selectedPhotos.has(img.id) ? 'opacity-100' : 'opacity-0'}"></div>

                        <div class="absolute top-3 right-3 z-20">
                            <div class="checkbox-ring ${selectedPhotos.has(img.id) ? 'selected' : ''}">
                                ${selectedPhotos.has(img.id) ? '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>' : ''}
                            </div>
                        </div>
                    </div>
                `).join('');
            } else {
                // RENDER FOR NORMAL MODE
                if (currentTab === 'VIDEOS') {
                    grid.innerHTML = images.map((img, idx) => `
                        <div class="gallery-item cursor-pointer overflow-hidden group relative" onclick="playVideoInline(this, '${img.id}')">
                            <div class="relative w-full pb-[56.25%] bg-zinc-900 rounded-lg overflow-hidden transition-all duration-300">
                                <!-- Thumbnail -->
                                <img src="${getDriveUrl(img.id)}" 
                                     class="absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-40 transition-opacity"
                                     onerror="this.src='https://images.unsplash.com/photo-1516035069371-29a1b244cc32?q=80&w=2000&auto=format&fit=crop'">
                                
                                <!-- Play Button -->
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="bg-white/10 backdrop-blur-md p-4 rounded-full border border-white/20 group-hover:scale-110 transition-transform shadow-xl">
                                        <i data-lucide="play" class="w-8 h-8 text-white fill-current"></i>
                                    </div>
                                </div>
                                
                                <!-- Title -->
                                <div class="absolute bottom-4 left-4 text-white text-xs font-bold tracking-widest uppercase">
                                    ${img.name}
                                </div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    grid.innerHTML = images.map((img, idx) => `
                        <div class="gallery-item cursor-pointer overflow-hidden group relative" onclick="openLightbox(${idx})">
                            <img src="${getDriveUrl(img.id)}" 
                                 class="w-full h-auto object-cover transition-opacity duration-500 group-hover:opacity-90"
                                 onerror="this.src='https://via.placeholder.com/800x1200?text=Access+Denied'">
                            
                            <!-- Gradient Overlay on Hover -->
                            <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"></div>

                            <!-- Bottom Right Action Buttons -->
                            <div class="absolute bottom-4 right-4 flex items-center gap-4 opacity-0 group-hover:opacity-100 transition-all duration-300 translate-y-2 group-hover:translate-y-0 z-10">
                                 <button onclick="event.stopPropagation(); shareImage('${img.id}')" class="text-white hover:text-zinc-200 transition-colors" title="Share Link">
                                    <i data-lucide="share" class="w-5 h-5"></i>
                                 </button>
                                 <button onclick="event.stopPropagation(); downloadImage('${img.id}')" class="text-white hover:text-zinc-200 transition-colors" title="Download">
                                    <i data-lucide="download" class="w-5 h-5"></i>
                                 </button>
                                 <button onclick="event.stopPropagation(); toggleLike('${img.id}')" class="text-white hover:text-red-500 transition-colors" title="Like">
                                    <i data-lucide="heart" class="w-5 h-5 ${likedPhotos.has(img.id) ? 'liked' : ''}"></i>
                                 </button>
                            </div>
                        </div>
                    `).join('');
                }
            }
            lucide.createIcons();
        }

        // --- CONTACT MODAL LOGIC ---
        function openContactModal() {
            const modal = document.getElementById('contact-modal');
            const content = document.getElementById('contact-modal-content');

            modal.classList.remove('hidden');
            modal.classList.add('flex');

            setTimeout(() => {
                modal.classList.remove('opacity-0');
                content.classList.remove('scale-95');
                content.classList.add('scale-100');
            }, 10);
        }

        function closeContactModal() {
            const modal = document.getElementById('contact-modal');
            const content = document.getElementById('contact-modal-content');

            modal.classList.add('opacity-0');
            content.classList.remove('scale-100');
            content.classList.add('scale-95');

            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }, 300);
        }

        function saveContact() {
            const vCardData = `BEGIN:VCARD
VERSION:3.0
FN:SanStudio
TITLE:Wedding Web designer
TEL;TYPE=CELL:+919003356047
EMAIL:sanstudio.brand@gmail.com
URL:https://sanstudio.neocities.org/
END:VCARD`;

            const blob = new Blob([vCardData], { type: 'text/vcard' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'SanStudio.vcf';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // --- DOWNLOAD MENU & SELECTION LOGIC ---
        function toggleDownloadMenu() {
            const menu = document.getElementById('download-menu');
            if (menu.classList.contains('hidden')) {
                menu.classList.remove('hidden');
                menu.classList.add('flex');
            } else {
                menu.classList.add('hidden');
                menu.classList.remove('flex');
            }
        }

        function startSelectionMode() {
            isSelectionMode = true;
            selectedPhotos.clear();

            // Hide menu and chat
            document.getElementById('download-menu').classList.add('hidden');
            document.getElementById('download-menu').classList.remove('flex');
            document.getElementById('chat-bubble').classList.add('hidden');

            // Show selection bar and instructions
            document.getElementById('selection-bar').classList.remove('translate-y-full');
            document.getElementById('selection-instructions').classList.remove('hidden');

            renderGallery();
        }

        function cancelSelectionMode() {
            isSelectionMode = false;
            selectedPhotos.clear();

            // Hide selection bar and instructions
            document.getElementById('selection-bar').classList.add('translate-y-full');
            document.getElementById('selection-instructions').classList.add('hidden');

            // Show chat
            document.getElementById('chat-bubble').classList.remove('hidden');

            renderGallery();
        }

        function toggleSelection(id) {
            if (selectedPhotos.has(id)) {
                selectedPhotos.delete(id);
            } else {
                selectedPhotos.add(id);
            }
            document.getElementById('selected-count').textContent = selectedPhotos.size;
            renderGallery(); // Re-render to update checkboxes state
        }

        function selectAll() {
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else images = ALBUM_DATA.videos;

            images.forEach(img => selectedPhotos.add(img.id));
            document.getElementById('selected-count').textContent = selectedPhotos.size;
            renderGallery();
        }

        async function downloadSelectedBatch() {
            if (selectedPhotos.size === 0) {
                alert("Please select at least one photo.");
                return;
            }

            const folderName = prompt("Enter a folder name for these photos:", "My_Wedding_Photos");
            if (!folderName) return; // User cancelled

            const idsToDownload = Array.from(selectedPhotos);
            await downloadAsZip(idsToDownload, folderName);
            cancelSelectionMode();
        }

        async function downloadAllInTab() {
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else {
                alert("Batch download not supported for videos yet.");
                return;
            }

            const folderName = prompt(`Enter folder name for all ${currentTab} photos:`, `${currentTab.replace(' ', '_')}_Photos`);
            if (!folderName) return;

            const ids = images.map(img => img.id);
            if (ids.length === 0) {
                alert("No photos to download.");
                return;
            }

            await downloadAsZip(ids, folderName);

            // Hide menu
            const menu = document.getElementById('download-menu');
            menu.classList.add('hidden');
            menu.classList.remove('flex');
        }

        async function downloadAsZip(ids, folderName) {
            const zip = new JSZip();
            const folder = zip.folder(folderName);

            // Show loading state (simple alert for now, or we could add a toast later if needed)
            const count = ids.length;
            const msg = document.createElement('div');
            msg.innerHTML = `
                <div id="dl-toast" class="fixed bottom-4 right-4 bg-black text-white px-6 py-4 rounded-lg shadow-2xl z-[200] flex items-center gap-3 animate-bounce">
                    <div class="animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"></div>
                    <div>
                        <p class="font-bold text-sm">Preparing Download...</p>
                        <p class="text-xs text-zinc-400">0 / ${count} photos processed</p>
                    </div>
                </div>
            `;
            document.body.appendChild(msg);
            const statusText = msg.querySelector('p.text-xs');

            let processed = 0;
            const errors = [];

            // We use the proxy 'https://lh3.googleusercontent.com/d/{id}' for fetching full size if possible, 
            // but for reliability with CORS on some drive links, we might need a workaround.
            // However, usually 'lh3.googleusercontent.com/d/' works significantly better than 'drive.google.com/uc?'.

            const promises = ids.map(async (id, index) => {
                try {
                    // Try fetch image
                    const url = getDriveUrl(id); // Using the display URL which is usually fetchable
                    // Note: If CORS fails here, we might need a proxy or fall back to individual window opening.
                    // Adding cache buster to avoid cached CORS issues
                    const response = await fetch(url + "?authuser=0", { mode: 'cors' });

                    if (!response.ok) throw new Error(`Failed to fetch ${id}`);

                    const blob = await response.blob();
                    folder.file(`photo_${index + 1}.jpg`, blob);
                } catch (err) {
                    console.error(err);
                    errors.push(id);
                } finally {
                    processed++;
                    statusText.textContent = `${processed} / ${count} photos processed`;
                }
            });

            await Promise.all(promises);

            if (processed === 0) {
                msg.remove();
                alert("Failed to download images. This might be due to browser security (CORS) on Google Drive images. Please try downloading individual images.");
                return;
            }

            statusText.textContent = "Zipping files...";

            try {
                const content = await zip.generateAsync({ type: "blob" });
                saveAs(content, `${folderName}.zip`);
            } catch (err) {
                console.error(err);
                alert("Error generating zip file.");
            }

            msg.remove();

            if (errors.length > 0) {
                alert(`Completed with ${errors.length} errors. Some photos could not be downloaded.`);
            }
        }

        // --- SHARE LOGIC ---
        function shareImage(id) {
            const url = getDriveUrl(id);
            const input = document.getElementById('share-url-input');
            const modal = document.getElementById('share-modal');
            const content = document.getElementById('share-modal-content');

            input.value = url;
            const encodedUrl = encodeURIComponent(url);
            document.getElementById('share-fb').href = `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`;
            document.getElementById('share-wa').href = `https://api.whatsapp.com/send?text=${encodedUrl}`;

            // Check if telegram element exists before setting href
            const tgLink = document.getElementById('share-tg');
            if (tgLink) {
                tgLink.href = `https://t.me/share/url?url=${encodedUrl}`;
            }

            document.getElementById('copy-btn-text').textContent = "Copy the link";
            document.getElementById('copy-btn').classList.remove('bg-zinc-800');
            document.getElementById('copy-btn').classList.add('bg-black');

            modal.classList.remove('hidden');
            modal.classList.add('flex');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                content.classList.remove('scale-95');
                content.classList.add('scale-100');
            }, 10);
        }

        function closeShareModal() {
            const modal = document.getElementById('share-modal');
            const content = document.getElementById('share-modal-content');
            modal.classList.add('opacity-0');
            content.classList.remove('scale-100');
            content.classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }, 300);
        }

        function copyShareLink() {
            const input = document.getElementById('share-url-input');
            input.select();
            input.setSelectionRange(0, 99999);
            navigator.clipboard.writeText(input.value).then(() => {
                const btnText = document.getElementById('copy-btn-text');
                const btn = document.getElementById('copy-btn');
                btnText.textContent = "Copied to clipboard!";
                btn.classList.remove('bg-black');
                btn.classList.add('bg-zinc-800');
                setTimeout(() => {
                    btnText.textContent = "Copy the link";
                    btn.classList.add('bg-black');
                    btn.classList.remove('bg-zinc-800');
                }, 2000);
            });
        }

        // --- LIKE, DOWNLOAD SINGLE, NAVIGATION (Existing) ---
        function toggleLike(id) {
            if (likedPhotos.has(id)) likedPhotos.delete(id);
            else likedPhotos.add(id);
            localStorage.setItem('wedding_likes', JSON.stringify(Array.from(likedPhotos)));
            updateLikeCount();
            renderGallery();
            updateLightboxHeart();
        }

        function toggleLikeCurrent() {
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else images = ALBUM_DATA.videos;

            const currentId = images[currentIndex].id;
            toggleLike(currentId);
        }

        function updateLikeCount() {
            document.getElementById('like-count').textContent = likedPhotos.size;
            const navHeart = document.getElementById('nav-heart').querySelector('svg');
            if (likedPhotos.size > 0) navHeart?.classList.add('liked');
            else navHeart?.classList.remove('liked');
        }

        function updateLightboxHeart() {
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else images = ALBUM_DATA.videos;

            if (!images[currentIndex]) return;
            const heartIcon = document.getElementById('lb-heart-btn').querySelector('svg');
            if (likedPhotos.has(images[currentIndex].id)) heartIcon?.classList.add('liked');
            else heartIcon?.classList.remove('liked');
        }

        function downloadImage(id) {
            const link = document.createElement('a');
            link.href = getDownloadUrl(id);
            link.setAttribute('download', `wedding-photo-${id}.jpg`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function downloadCurrent() {
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else images = ALBUM_DATA.videos;

            const id = images[currentIndex].id;
            downloadImage(id);
        }

        function shareCurrent() {
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else images = ALBUM_DATA.videos;

            const id = images[currentIndex].id;
            shareImage(id);
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch((e) => {
                    console.error(`Error attempting to enable fullscreen mode: ${e.message} (${e.name})`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        function scrollToGallery() {
            document.getElementById('gallery-section').scrollIntoView({ behavior: 'smooth' });
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('tab-active', 'text-zinc-900');
                btn.classList.add('text-zinc-400');
            });
            const activeBtn =
                tab === 'CAM 01' ? document.getElementById('tab-01') :
                    tab === 'CAM 02' ? document.getElementById('tab-02') :
                        document.getElementById('tab-videos');

            if (activeBtn) {
                activeBtn.classList.add('tab-active', 'text-zinc-900');
                activeBtn.classList.remove('text-zinc-400');
            }

            // Layout Shift for Videos
            const grid = document.getElementById('photo-grid');
            if (tab === 'VIDEOS') {
                grid.classList.add('video-columns');
            } else {
                grid.classList.remove('video-columns');
            }

            document.getElementById('current-tab-name').textContent = currentTab;

            renderGallery();
        }

        function openLightbox(index) {
            if (isSelectionMode) return;
            currentIndex = index;
            const images = currentTab === 'CAM 01' ? ALBUM_DATA.cam01 : (currentTab === 'CAM 02' ? ALBUM_DATA.cam02 : ALBUM_DATA.videos);
            const img = images[index];

            const imgEl = document.getElementById('lb-img');
            const videoEl = document.getElementById('lb-video');

            if (currentTab === 'VIDEOS') {
                imgEl.classList.add('hidden');
                videoEl.classList.remove('hidden');
                videoEl.src = getVideoUrl(img.id);
            } else {
                videoEl.classList.add('hidden');
                videoEl.src = ""; // Stop playback
                imgEl.classList.remove('hidden');
                imgEl.src = getDriveUrl(img.id);
            }

            document.getElementById('lb-counter').textContent = `${index + 1} / ${images.length}`;
            document.getElementById('lightbox').classList.remove('hidden');
            document.getElementById('lightbox').classList.add('flex');
            document.body.style.overflow = 'hidden';
            updateLightboxHeart();
            lucide.createIcons();
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.add('hidden');
            document.getElementById('lightbox').classList.remove('flex');
            document.body.style.overflow = '';
            isZoomed = false;
            document.getElementById('lb-img').classList.remove('zoom-active');
            document.getElementById('lb-video').src = ""; // Stop video
        }

        function changePhoto(dir) {
            let images;
            if (currentTab === 'CAM 01') images = ALBUM_DATA.cam01;
            else if (currentTab === 'CAM 02') images = ALBUM_DATA.cam02;
            else images = ALBUM_DATA.videos;

            currentIndex = (currentIndex + dir + images.length) % images.length;
            openLightbox(currentIndex);
        }

        function toggleZoom() {
            isZoomed = !isZoomed;
            document.getElementById('lb-img').classList.toggle('zoom-active', isZoomed);
        }

        function playVideoInline(container, id) {
            // Find the inner container that holds thumbnail and overlays
            const inner = container.querySelector('.relative.w-full');

            // Replace with iframe
            inner.innerHTML = `
                <iframe src="${getVideoUrl(id)}" 
                        class="absolute inset-0 w-full h-full rounded-lg" 
                        frameborder="0" 
                        allow="autoplay; encrypted-media" 
                        allowfullscreen>
                </iframe>
            `;
            // Remove onClick so it doesn't try to play again or reload
            container.onclick = null;
            container.classList.remove('cursor-pointer', 'group'); // Remove hover effects
        }

        function filterLikes() {
            if (likedPhotos.size === 0) {
                alert("You haven't liked any photos yet!");
                return;
            }
            const grid = document.getElementById('photo-grid');
            const allImages = [...ALBUM_DATA.cam01, ...ALBUM_DATA.cam02, ...ALBUM_DATA.videos];
            const favorites = allImages.filter(img => likedPhotos.has(img.id));
            grid.innerHTML = favorites.map((img, idx) => `
                <div class="gallery-item cursor-pointer overflow-hidden group relative" onclick="openLightbox(${idx})">
                    <img src="${getDriveUrl(img.id)}" class="w-full h-auto object-cover">
                </div>
            `).join('');
            document.getElementById('gallery-subtitle').textContent = "MY FAVORITES";
            lucide.createIcons();
        }

        window.onload = init;
    </script>
</body>

</html>
